server {
	server_name openbank.vsund.de
	            openbank.valentin-sundermann.de;

	include snippets/misc/listen-80.conf; # ipv{4,6} + http
	include snippets/hardening/headers.conf;
	include snippets/misc/acme.conf;

	location / {
		return 301 https://$server_name$request_uri;
	}
}

server {
	server_name openbank.vsund.de
	            openbank.valentin-sundermann.de
	            ob7rrahhuquz6wvl.onion;

	include snippets/misc/listen.conf; # ipv{4,6} + http{,s}
	listen 127.0.0.1:80; # tor onion service

	include snippets/tls/tls-vsund-openbank.conf;
	include snippets/hardening/headers-tls.conf;
	include snippets/rewrites/no-www.conf;
	include snippets/misc/custom-errorpages.conf;

	root /data/www/openbank/public;

	index index.php index.html index.htm;

	location / {
		try_files $uri $uri/ /index.php$is_args$args;
	}

	include snippets/apps/php-fpm.conf;

	include snippets/hardening/denied-locations.conf;
}
